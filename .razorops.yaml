version: v2
global:
  runner:
    os_image: ubuntu

tasks:
  deploy-to-dev:
    steps:
    - checkout
    - commands:
          - az login --service-principal -u $appID -p $password --tenant $tenant
          - az storage blob upload-batch -s build/ -d '$web' --account-name razorops --overwrite true
    when: branch == 'main'

  deploy-to-stage:
    steps:
      - checkout
      - commands:
          - az login --service-principal -u $appID -p $password --tenant $tenant
          - az storage blob upload-batch -s build/ -d '$web' --account-name razorops --overwrite true       
    when: branch == 'main'
      
    - reports/html:
        dir: coverage
        index: index.html
